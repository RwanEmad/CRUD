
let products_container = [
    {
        id: 1,
        name: "iPhone 9",
        description: "An apple mobile which is nothing like apple",
        price: 549,
        quantity: 94,
        imgUrl: "https://cdn.dummyjson.com/product-images/1/thumbnail.jpg",
        category: "mobile",
    },
    {
        id: 2,
        name: "iPhone X",
        description: "SIM-Free, Model A19211 6.5-inch Super Retina HD display with OLED technology A12 Bionic chip with ...",
        price: 899,
        quantity: 34,
        imgUrl: "https://cdn.dummyjson.com/product-images/2/thumbnail.jpg",
        category: "mobile",
    },
    {
        id: 3,
        name: "Samsung Universe 9",
        description: "Samsung's new variant which goes beyond Galaxy to the Universe",
        price: 1249,
        quantity: 36,
        imgUrl: "https://cdn.dummyjson.com/product-images/3/thumbnail.jpg",
        category: "mobile",
    },
    {
        id: 4,
        name: "OPPOF19",
        description: "OPPO F19 is officially announced on April 2021.",
        price: 280,
        quantity: 123,
        imgUrl: "https://cdn.dummyjson.com/product-images/4/thumbnail.jpg",
        category: "mobile",
    },
    {
        id: 5,
        name: "Huawei P30",
        description: "Huawei�s re-badged P30 Pro New Edition was officially unveiled yesterday in Germany and now the device has made its way to the UK.",
        price: 499,
        quantity: 32,
        imgUrl: "https://cdn.dummyjson.com/product-images/5/thumbnail.jpg",
        category: "mobile",
    },
    {
        id: 6,
        name: "MacBook Pro",
        description: "MacBook Pro 2021 with mini-LED display may launch between September, November",
        price: 1749,
        quantity: 83,
        imgUrl: "https://cdn.dummyjson.com/product-images/6/thumbnail.png",
        category: "laptop",
    },
    {
        id: 7,
        name: "Samsung Galaxy Book",
        description: "Samsung Galaxy Book S (2020) Laptop With Intel Lakefield Chip, 8GB of RAM Launched",
        price: 1499,
        quantity: 50,
        imgUrl: "https://cdn.dummyjson.com/product-images/7/thumbnail.jpg",
        category: "laptop",
    },
    {
        id: 8,
        name: "Microsoft Surface Laptop 4",
        description: "Style and speed. Stand out on HD video calls backed by Studio Mics. Capture ideas on the vibrant touchscreen.",
        price: 1499,
        quantity: 68,
        imgUrl: "https://cdn.dummyjson.com/product-images/8/thumbnail.jpg",
        category: "laptop",
    },
    {
        id: 9,
        name: "Infinix INBOOK",
        description: "Infinix Inbook X1 Ci3 10th 8GB 256GB 14 Win10 Grey � 1 Year Warranty",
        price: 1099,
        quantity: 96,
        imgUrl: "https://cdn.dummyjson.com/product-images/9/thumbnail.jpg",
        category: "laptop",
    },
    {
        id: 10,
        name: "HP Pavilion 15-DK1056WM",
        description: "HP Pavilion 15-DK1056WM Gaming Laptop 10th Gen Core i5, 8GB, 256GB SSD, GTX 1650 4GB, Windows 10",
        price: 1099,
        quantity: 89,
        imgUrl: "https://cdn.dummyjson.com/product-images/10/thumbnail.jpeg",
        category: "laptop",
    },
    {
        id: 11,
        name: "perfume Oil",
        description: "Mega Discount, Impression of Acqua Di Gio by GiorgioArmani concentrated attar perfume Oil",
        price: 13,
        quantity: 65,
        imgUrl: "https://cdn.dummyjson.com/product-images/11/thumbnail.jpg",
        category: "perfume",
    },
    {
        id: 12,
        name: "Brown Perfume",
        description: "Royal_Mirage Sport Brown Perfume for Men & Women - 120ml",
        price: 40,
        quantity: 52,
        imgUrl: "https://cdn.dummyjson.com/product-images/12/thumbnail.jpg",
        category: "perfume",
    },
    {
        id: 13,
        name: "Fog Scent Xpressio Perfume",
        description: "Product details of Best Fog Scent Xpressio Perfume 100ml For Men cool long lasting perfumes for Men",
        price: 13,
        quantity: 61,
        imgUrl: "https://cdn.dummyjson.com/product-images/13/thumbnail.webp",
        category: "perfume",
    },
    {
        id: 14,
        name: "Non-Alcoholic Concentrated Perfume Oil",
        description: "Original Al Munakh� by Mahal Al Musk | Our Impression of Climate | 6ml Non-Alcoholic Concentrated Perfume Oil",
        price: 120,
        quantity: 114,
        imgUrl: "https://cdn.dummyjson.com/product-images/14/thumbnail.jpg",
        category: "perfume",
    },
    {
        id: 15,
        name: "Eau De Perfume Spray",
        description: "Genuine  Al-Rehab spray perfume from UAE/Saudi Arabia/Yemen High Quality",
        price: 30,
        quantity: 105,
        imgUrl: "https://cdn.dummyjson.com/product-images/15/thumbnail.jpg",
        category: "perfume",
    },
    {
        id: 16,
        name: "Hyaluronic Acid Serum",
        description: "L'Oréal Paris introduces Hyaluron Expert Replumping Serum formulated with 1.5% Hyaluronic Acid",
        price: 19,
        quantity: 110,
        imgUrl: "https://cdn.dummyjson.com/product-images/16/thumbnail.jpg",
        category: "perfume",
    },
    {
        id: 17,
        name: "Tree Oil 30ml",
        description: "Tea tree oil contains a number of compounds, including terpinen-4-ol, that have been shown to kill certain bacteria,",
        price: 12,
        quantity: 78,
        imgUrl: "https://cdn.dummyjson.com/product-images/17/thumbnail.jpg",
        category: "medicen",
    },
    {
        id: 18,
        name: "Oil Free Moisturizer 100ml",
        description: "Dermive Oil Free Moisturizer with SPF 20 is specifically formulated with ceramides, hyaluronic acid & sunscreen.",
        price: 40,
        quantity: 88,
        imgUrl: "https://cdn.dummyjson.com/product-images/18/thumbnail.jpg",
        category: "medicen",
    },
    {
        id: 19,
        name: "Skin Beauty Sername",
        description: "Product name: rorec collagen hyaluronic acid white face serum riceNet weight: 15 m",
        price: 46,
        quantity: 54,
        imgUrl: "https://cdn.dummyjson.com/product-images/19/thumbnail.jpg",
        category: "medicen",
    },
    {
        id: 20,
        name: "Freckle Treatment Cream- 15gm",
        description: "Fair & Clear is Pakistan's only pure Freckle cream which helpsfade Freckles, Darkspots and pigments. Mercury level is 0%, so there are no side effects.",
        price: 70,
        quantity: 140,
        imgUrl: "https://cdn.dummyjson.com/product-images/20/thumbnail.jpg",
        category: "medicen",
    },
    {
        id: 21,
        name: "Elbow Macaroni - 400 gm",
        description: "Product details of Bake Parlor Big Elbow Macaroni - 400 gm",
        price: 14,
        quantity: 146,
        imgUrl: "https://cdn.dummyjson.com/product-images/22/thumbnail.jpg",
        category: "foods",
    },
    {
        id: 22,
        name: "Orange Essence Food Flavou",
        description: "Specifications of Orange Essence Food Flavour For Cakes and Baking Food Item",
        price: 14,
        quantity: 26,
        imgUrl: "https://cdn.dummyjson.com/product-images/23/thumbnail.jpg",
        category: "foods",
    },
    {
        id: 23,
        name: "cereals muesli fruit nuts",
        description: "original fauji cereal muesli 250gm box pack original fauji cereals muesli fruit nuts flakes breakfast cereal break fast faujicereals cerels cerel foji fouji",
        price: 46,
        quantity: 113,
        imgUrl: "https://cdn.dummyjson.com/product-images/24/thumbnail.jpg",
        category: "foods",
    },
    {
        id: 24,
        name: "Gulab Powder 50 Gram",
        description: "Dry Rose Flower Powder Gulab Powder 50 Gram � Treats Wounds",
        price: 70,
        quantity: 47,
        imgUrl: "https://cdn.dummyjson.com/product-images/25/thumbnail.jpg",
        category: "foods",
    },
    {
        id: 25,
        name: "Plant Hanger For Home",
        description: "Boho Decor Plant Hanger For Home Wall Decoration Macrame Wall Hanging Shelf",
        price: 41,
        quantity: 131,
        imgUrl: "https://cdn.dummyjson.com/product-images/26/thumbnail.jpg",
        category: "hand made",
    },
    {
        id: 26,
        name: "Flying Wooden Bird",
        description: "Package Include 6 Birds with Adhesive Tape Shape: 3D Shaped Wooden Birds Material: Wooden MDF, Laminated 3.5mm",
        price: 51,
        quantity: 17,
        imgUrl: "https://cdn.dummyjson.com/product-images/27/thumbnail.webp",
        category: "hand made",
    },
    {
        id: 27,
        name: "3D Embellishment Art Lamp",
        description: "3D led lamp sticker Wall sticker 3d wall art light on/off button  cell operated (included)",
        price: 20,
        quantity: 54,
        imgUrl: "https://cdn.dummyjson.com/product-images/28/thumbnail.jpg",
        category: "hand made",
    },
    {
        id: 28,
        name: "Handcraft Chinese style",
        description: "Handcraft Chinese style art luxury palace hotel villa mansion home decor ceramic vase with brass fruit plate",
        price: 60,
        quantity: 7,
        imgUrl: "https://cdn.dummyjson.com/product-images/29/thumbnail.webp",
        category: "hand made",
    },
    {
        id: 29,
        name: "Key Holder",
        description: "Attractive DesignMetallic materialFour key hooksReliable & DurablePremium Quality",
        price: 30,
        quantity: 54,
        imgUrl: "https://cdn.dummyjson.com/product-images/30/thumbnail.jpg",
        category: "hand made",
    }
]


let pro_name = document.getElementById("pro-name");
let pro_category = document.getElementById("pro-category");
let price = document.getElementById("pro-price");
let pro_description = document.getElementById("pro-description");
let pro_img = document.getElementById("pro-image");

let categoryProducts = null




if (localStorage.getItem("allProducts") != null) {
    products_container = JSON.parse(localStorage.getItem("allProducts"))
    displayProducts(products_container, "products")

}
else {
    localStorage.setItem("allProducts", JSON.stringify(products_container))
    displayProducts(products_container, "products")
}

function addProduct() {
    let path = ""
    if (pro_img.files[0]) {
        path = pro_img.files[0].name
    }
    else {
        path = "portfolio-details-2.jpg"
    }

    console.log(pro_img.files)
    let product = {
        name: pro_name.value,
        imgUrl: `images/${path}`,
        category: pro_category.value,
        price: price.value,
        description: pro_description.value
    }
    // console.log(product)
    products_container.push(product);
    categoryProducts.push(product)
    displayCategory(categoryProducts, product.category)
    displayProducts(products_container, "products")
    clearInput()
    localStorage.setItem("allProducts", JSON.stringify(products_container))
    alert(product.name + "added successfully")
}

function display_products() {
    let cartona = `
    <div class="col-3">
    <a href="#"data-bs-toggle="modal"
    data-bs-target="#formModal" class="text-decoration-none">
        <div class="card d-grid add_card shadow border-0 ">
            <div class="icon m-auto d-grid rounded-circle">
                <i class="fa-solid fa-plus m-auto  "></i>
            </div>
        </div>
    </a>

</div>

    `;
    // let cartona = "";
    for (let i = 0; i < products_container.length; i++) {
        cartona += `  <div class="col-md-3 ">
    <div class="card p-2 rounded border-0">
        <div class="image ">
            <img src="${products_container[i].imgUrl}" height="200"  alt="Avatar" class="w-100 rounded">
        </div>
        <div class="card-body p-3 pt-4">
            <h6 class="card-title">${products_container[i].name}</h6>
            <div class="d-flex justify-content-between">
            <span>category:${products_container[i].category} </span>
            <span>Price: ${products_container[i].price} EGP</span>
            
            </div>
            <div class="description">
          <p class="pt-3">${products_container[i].description}</p>
            </div>
        </div>

        <button onclick="deleteItem(${i})" class="btn btn-outline-danger w-100">Delete</button>
        <button onclick="setItems(${i})" class="btn btn-outline-success w-100 my-2">Update</button>
    </div>
</div>`

    }
    document.getElementById("products").innerHTML = cartona;
}

function clearInput() {
    pro_name.value = "";
    pro_category.value = "";
    price.value = "";
    pro_description.value = "";
    pro_img = ""
}


function deleteItem(index) {

    console.log(categoryProducts == null)

    console.log(index)

    if (categoryProducts == null) {
        console.log("CONTAINER- " + products_container[index].name)
        products_container.splice(index, 1)
        display_products()
    }
    else {
        for (i = 0; i < products_container.length; i++) {

            if (products_container[i].id == categoryProducts[index].id) {
                console.log("CATEGORY-" + categoryProducts[index].name)
                categoryProducts.splice(index, 1)
                displayCategory(categoryProducts, categoryProducts[index].category)

                // switch (categoryProducts[index].category) {
                //     case "mobile":
                //         displayProducts(categoryProducts, 'mobile-products')
                //         break;
                //     case "laptop":
                //         displayProducts(categoryProducts, 'laptop-products')
                //         break;
                //     case "perfume":
                //         displayProducts(categoryProducts, 'perfume-products')
                //         break;
                //     case "medicen":
                //         displayProducts(categoryProducts, 'medicen-products')
                //         break;
                //     case "foods":
                //         displayProducts(categoryProducts, 'food-products')
                //         break;
                //     case "hand made":
                //         displayProducts(categoryProducts, 'handMade-products')
                //         break;
                // }

                console.log("CONTAINER- " + products_container[i].name)
                products_container.splice(i, 1)
                display_products()
            }
        }
    }






    localStorage.setItem("allProducts", JSON.stringify(products_container))
}



function getCategory(category, id) {
    categoryProducts = products_container.filter((product) => product.category == category)
    console.log(categoryProducts == null)
    console.log(categoryProducts)
    displayProducts(categoryProducts, id)
}
function categoryProductsNull() {
    categoryProducts = null
}

function displayProducts(products, id) {
    let cartona = `
            <div class="col-3">
                <a href="#"data-bs-toggle="modal"
                data-bs-target="#formModal" class="text-decoration-none">
                    <div class="card d-grid add_card shadow border-0 ">
                        <div class="icon m-auto d-grid rounded-circle">
                            <i class="fa-solid fa-plus m-auto  "></i>
                        </div>
                    </div>
                </a>

            </div>

    `;
    // let cartona = ""
    for (let i = 0; i < products.length; i++) {
        cartona += `  <div class="col-md-3 ">
        <div class="card p-2 rounded border-0">
            <div class="image">
                <img src="${products[i].imgUrl}" height="200"  alt="Avatar" class="w-100 rounded">
            </div>
            <div class="card-body p-3 pt-4">
                <h6 class="card-title fw-bold">${products[i].name}</h6>
                <div class=" px-1">
               <p class="fw-bold mb-0" > Category: <span> ${products[i].category} </span></p>
               <p class="fw-bold mb-0"> Price:<span class="text-success"> ${products[i].price} EGP</span></p>
                </div>
                <div class="description mt-1">
              <p>${products[i].description}</p>
                </div>
            </div>
             <div class="">
             <button onclick="deleteItem(${i})" class="btn btn-outline-danger w-100">Delete</button>
            <button onclick="setItems(${i})" data-bs-toggle="modal"
            data-bs-target="#formModal" class="btn btn-outline-success w-100 my-2">Update</button>
             </div>
            
        </div>
    </div>`

    }
    document.getElementById(id).innerHTML = cartona;
}


function displayCategory(products, cat) {
    switch (cat) {
        case "mobile":
            displayProducts(products, 'mobile-products')
            break;
        case "laptop":
            displayProducts(products, 'laptop-products')
            break;
        case "perfume":
            displayProducts(products, 'perfume-products')
            break;
        case "medicen":
            displayProducts(products, 'medicen-products')
            break;
        case "foods":
            displayProducts(products, 'food-products')
            break;
        case "hand made":
            displayProducts(products, 'handMade-products')
            break;

    }
}
let index
function setItems(proIndex) {
    index = proIndex
    document.getElementById("updateBtn").style.display = "block"
    document.getElementById("addBtn").style.display = "none"

    if (categoryProducts != null) {
        console.log("category isNot NULL")
        pro_name.value = categoryProducts[proIndex].name
        pro_category.value = categoryProducts[proIndex].category
        price.value = categoryProducts[proIndex].price
        pro_description.value = categoryProducts[proIndex].description
        console.log(pro_name.value, pro_category.value)
    }
    else {
        console.log("category is NULL")
        pro_name.value = products_container[proIndex].name
        pro_category.value = products_container[proIndex].category
        price.value = products_container[proIndex].price
        pro_description.value = products_container[proIndex].description
        console.log(pro_name.value, pro_category.value)

    }
}



function update() {
    // index = 2
    document.getElementById("updateBtn").style.display = "none"
    document.getElementById("addBtn").style.display = "block"

    if (categoryProducts != null) {
        console.log("category isNot NULL")
        categoryProducts[index].name = pro_name.value
        categoryProducts[index].category = pro_category.value
        categoryProducts[index].price = price.value
        categoryProducts[index].description = pro_description.value
        console.log(pro_name.value, pro_category.value)

        products_container[index].name = pro_name.value
        products_container[index].category = pro_category.value
        products_container[index].price = price.value
        products_container[index].description = pro_description.value

        displayCategory(categoryProducts, categoryProducts[index].category)
        displayProducts(products_container, "products")
    }
    else {
        products_container[index].name = pro_name.value
        products_container[index].category = pro_category.value
        products_container[index].price = price.value
        products_container[index].description = pro_description.value
        displayProducts(products_container, "products")
    }
    localStorage.setItem("allProducts", JSON.stringify(products_container))
    console.log(pro_name.value)
    clearInput()
}


function searchProduct(searchKey) {
    let searchResult = []
    for (i = 0; i < products_container.length; i++) {
        if (products_container[i].name.toLowerCase().includes(searchKey.toLowerCase())) {
            console.log(products_container[i])
            searchResult.push(products_container[i])
        }
    }
    displayProducts(searchResult, "products")
    console.log("SEARCH RESULT IS" + searchResult)
}